{% extends "base.html" %}

{% block title %}Search - PHM{% endblock %}

{% block content %}
<div class="card">
    <h2 style="margin-bottom: 20px;">Search Highlights</h2>

    <form hx-get="/search" hx-target="#search-results"
        hx-trigger="input changed delay:300ms from:#search-input, change from:select">
        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
            <input type="text" id="search-input" name="q" value="{{ query or '' }}"
                placeholder="Search highlights, notes, and sources..." style="flex: 1;" autofocus>
        </div>

        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
            <select name="source_type">
                <option value="">All Types</option>
                <option value="book" {% if source_type=='book' %}selected{% endif %}>Book</option>
                <option value="article" {% if source_type=='article' %}selected{% endif %}>Article</option>
                <option value="web" {% if source_type=='web' %}selected{% endif %}>Web</option>
                <option value="pdf" {% if source_type=='pdf' %}selected{% endif %}>PDF</option>
                <option value="video" {% if source_type=='video' %}selected{% endif %}>Video</option>
                <option value="podcast" {% if source_type=='podcast' %}selected{% endif %}>Podcast</option>
            </select>

            <select name="status">
                <option value="">All Status</option>
                <option value="active" {% if status=='active' %}selected{% endif %}>Active</option>
                <option value="archived" {% if status=='archived' %}selected{% endif %}>Archived</option>
            </select>

            <select name="favorite">
                <option value="">All Highlights</option>
                <option value="true" {% if favorite=='true' %}selected{% endif %}>Favorites Only</option>
            </select>
        </div>
    </form>
</div>

<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3>Results</h3>
        <small style="color: #666;" id="results-count">{{ results|length }} highlight{% if results|length != 1 %}s{%
            endif %}</small>
    </div>

    <div id="search-results">
        {% include "partials/search_results.html" %}
    </div>
</div>
{% endblock %}