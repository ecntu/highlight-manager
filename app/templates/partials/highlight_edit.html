<div class="card" style="padding: 32px;">
    <form hx-patch="/highlights/{{ highlight.id }}" hx-target="#highlight-container" hx-swap="innerHTML">
        <div class="form-group">
            <label>Highlight Text</label>
            <textarea name="text" rows="6" required
                style="font-size: 15px; line-height: 1.6;">{{ highlight.text }}</textarea>
        </div>

        <div class="form-group">
            <label>Your Note</label>
            <textarea name="note" rows="3" placeholder="Why does this matter?"
                style="font-size: 14px;">{{ highlight.note or '' }}</textarea>
        </div>

        <div class="form-group">
            <label>Tags (comma-separated)</label>
            <input type="text" name="tags"
                value="{% if highlight.tags %}{% for tag in highlight.tags %}{{ tag.name }}{% if not loop.last %}, {% endif %}{% endfor %}{% endif %}"
                placeholder="productivity, inspiration, ideas">
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="form-group">
                <label>Source URL (for web)</label>
                <input type="text" name="source_url" value="{{ highlight.url or '' }}"
                    placeholder="https://example.com/article">
            </div>

            <div class="form-group">
                <label>Source Title (for books)</label>
                <input type="text" name="source_title"
                    value="{{ highlight.source.title if highlight.source and highlight.source.type.value == 'book' else '' }}"
                    placeholder="Book title">
            </div>
        </div>

        <div class="form-group">
            <label>Author</label>
            <input type="text" name="source_author"
                value="{{ highlight.page_author or (highlight.source.author if highlight.source else '') }}"
                placeholder="Author name">
        </div>

        <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button type="submit">Save Changes</button>
            <button type="button" hx-get="/highlights/{{ highlight.id }}" hx-target="#highlight-container"
                hx-swap="innerHTML" class="secondary">Cancel</button>
        </div>
    </form>
</div>