<div id="highlight-view" class="card" style="padding: 20px 24px;">
    <form hx-patch="/highlights/{{ highlight.id }}" hx-target="#highlight-view" hx-swap="outerHTML">
        <div class="form-group">
            <label>Highlight Text</label>
            <textarea name="text" rows="6" required
                style="font-size: 15px; line-height: 1.6;">{{ highlight.text }}</textarea>
        </div>

        <div class="form-group">
            <label>Your Note</label>
            <textarea name="note" rows="3" placeholder="Why does this matter?"
                style="font-size: 14px;">{{ highlight.note or '' }}</textarea>
        </div>

        <div class="form-group">
            <label>Tags (comma-separated)</label>
            <input type="text" name="tags"
                value="{% if highlight.tags %}{% for tag in highlight.tags %}{{ tag.name }}{% if not loop.last %}, {% endif %}{% endfor %}{% endif %}"
                placeholder="productivity, inspiration, ideas">
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="form-group">
                <label>Source URL (for web)</label>
                <input type="text" name="source_url" value="{{ highlight.url or '' }}"
                    placeholder="https://example.com/article">
            </div>

            <div class="form-group">
                <label>Source Title (for books)</label>
                <input type="text" name="source_title"
                    value="{{ highlight.source.title if highlight.source and highlight.source.type.value == 'book' else '' }}"
                    placeholder="Book title">
            </div>
        </div>

        <div class="form-group">
            <label>Author</label>
            <input type="text" name="source_author"
                value="{{ highlight.page_author or (highlight.source.author if highlight.source else '') }}"
                placeholder="Author name">
        </div>

        <div style="display: flex; gap: 10px; margin-top: 16px; align-items: center;">
            <button type="submit"
                style="padding: 10px 18px; border-radius: 8px; background: white; color: #6b7280; border: 1px solid #e5e5e5; font-weight: 600; letter-spacing: 0.01em; transition: all 0.15s;"
                onmouseover="this.style.borderColor='#d1d5db'; this.style.background='#f9fafb';"
                onmouseout="this.style.borderColor='#e5e5e5'; this.style.background='white';">Save</button>
            <button type="button" hx-get="/highlights/{{ highlight.id }}" hx-target="#highlight-view"
                hx-swap="outerHTML" class="secondary"
                style="padding: 9px 16px; border-radius: 8px; background: white; color: #6b7280; border: 1px solid #e5e5e5; font-weight: 600; transition: all 0.15s;"
                onmouseover="this.style.borderColor='#d1d5db'; this.style.background='#f9fafb';"
                onmouseout="this.style.borderColor='#e5e5e5'; this.style.background='white';">Cancel</button>
        </div>
    </form>
</div>
