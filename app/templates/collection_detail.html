{% extends "base.html" %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px;">
        <div>
            <h2 style="margin-bottom: 5px;">{{ collection.name }}</h2>
            <p style="color: #666; margin-bottom: 10px;">{{ collection.description or "No description" }}</p>
            <small style="color: #999;">{{ collection.highlights|length }} highlights</small>
        </div>
        <div style="display: flex; gap: 10px;">
            <button onclick="document.getElementById('edit-form').style.display='block'; this.style.display='none';"
                style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">
                Edit
            </button>
            <button hx-delete="/collections/{{ collection.id }}"
                hx-confirm="Are you sure you want to delete this collection?" hx-target="body"
                hx-on::after-request="window.location='/collections'"
                style="padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">
                Delete
            </button>
        </div>
    </div>

    <form id="edit-form"
        style="display: none; margin-bottom: 20px; padding: 20px; background: #f8f9fa; border-radius: 4px;"
        hx-patch="/collections/{{ collection.id }}" hx-target="#edit-form" hx-swap="beforebegin">
        <div class="form-group">
            <label>Name</label>
            <input type="text" name="name" value="{{ collection.name }}" required>
        </div>
        <div class="form-group">
            <label>Description</label>
            <textarea name="description" rows="3">{{ collection.description or "" }}</textarea>
        </div>
        <div style="display: flex; gap: 10px;">
            <button type="submit"
                style="padding: 10px 18px; border-radius: 8px; background: white; color: #6b7280; border: 1px solid #e5e5e5; font-weight: 600; letter-spacing: 0.01em; transition: all 0.15s;"
                onmouseover="this.style.borderColor='#d1d5db'; this.style.background='#f9fafb';"
                onmouseout="this.style.borderColor='#e5e5e5'; this.style.background='white';">Save Changes</button>
            <button type="button"
                onclick="this.closest('form').style.display='none'; this.closest('.card').querySelector('button').style.display='inline-block';"
                style="padding: 9px 16px; border-radius: 8px; background: white; color: #6b7280; border: 1px solid #e5e5e5; font-weight: 600; transition: all 0.15s;"
                onmouseover="this.style.borderColor='#d1d5db'; this.style.background='#f9fafb';"
                onmouseout="this.style.borderColor='#e5e5e5'; this.style.background='white';">
                Cancel
            </button>
        </div>
    </form>
</div>

<div class="card">
    <h3 style="margin-bottom: 15px;">Highlights in this Collection</h3>
    {% if collection.highlights %}
    <div style="display: grid; gap: 15px;">
        {% for highlight in collection.highlights %}
        <div style="padding: 15px; background: #f8f9fa; border-radius: 4px; position: relative;">
            <button hx-delete="/collections/{{ collection.id }}/highlights/{{ highlight.id }}" hx-target="closest div"
                hx-swap="outerHTML"
                style="position: absolute; top: 10px; right: 10px; padding: 4px 8px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                Remove
            </button>
            <p style="margin-bottom: 10px;">{{ highlight.text }}</p>
            {% if highlight.source %}
            <small style="color: #666;">
                From: <a href="/sources/{{ highlight.source.id }}" style="color: #007bff; text-decoration: none;">
                    {{ highlight.source.title }}
                </a>
            </small>
            {% endif %}
            <br>
            <a href="/highlights/{{ highlight.id }}" style="color: #007bff; text-decoration: none; font-size: 12px;">
                View details â†’
            </a>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p style="color: #666; text-align: center; padding: 40px 0;">
        No highlights in this collection yet.
    </p>
    {% endif %}
</div>

<div style="margin-top: 20px;">
    <a href="/collections" style="color: #007bff; text-decoration: none;">&larr; Back to Collections</a>
</div>
{% endblock %}
