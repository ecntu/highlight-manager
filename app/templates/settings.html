{% extends "base.html" %}

{% block content %}
<h1 style="margin-bottom: 24px; font-size: 24px; font-weight: 600;">Settings</h1>

<div class="card">
    <h2 class="section-title" style="margin-bottom: 16px;">Account</h2>
    <p class="muted" style="margin-bottom: 20px; font-size: 14px;">Signed in as <strong
            style="color: #1a1a1a;">{{ current_user.username }}</strong></p>
    <a href="/logout" class="btn btn--ghost btn--sm" style="text-decoration: none;">Logout</a>
</div>

<div class="card">
    <h2 class="section-title" style="margin-bottom: 20px;">Device API Keys</h2>

    <form hx-post="/devices" hx-target="#devices-table" hx-swap="outerHTML" style="margin-bottom: 28px;">
        <div class="row">
            <input type="text" name="name" placeholder="Device name (e.g., iPhone, MacBook)" required
                style="flex: 1;">
            <button type="submit" class="btn btn--ghost">
                Create Device Key
                <span class="htmx-indicator">...</span>
            </button>
        </div>
    </form>

    <h3 style="margin-bottom: 16px; font-size: 15px; font-weight: 600; color: #1a1a1a;">Active Devices</h3>
    {% include "partials/devices_table.html" %}

    <!-- Usage Instructions -->
    <div style="margin-top: 32px; padding-top: 32px; border-top: 1px solid #e5e5e5;">
        <h3 style="margin-bottom: 12px; font-size: 15px; font-weight: 600; color: #1a1a1a;">Using Device Keys</h3>
        <p style="color: #6b7280; margin-bottom: 16px; font-size: 14px;">Send highlights from any device using:</p>
        <pre
            style="background: #fafafa; padding: 16px; border-radius: 8px; overflow-x: auto; font-size: 12px; border: 1px solid #e5e5e5; line-height: 1.6;">curl -X POST {{ request.url.scheme }}://{{ request.url.netloc }}/api/highlights \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -F "text=Your highlight text" \
  -F "note=Optional note" \
  -F "tags=tag1,tag2" \
  -F "source_url=https://example.com/article" \
  -F "source_title=Article Title" \
  -F "source_author=Author Name"

# For books, use title instead of URL:
curl -X POST {{ request.url.scheme }}://{{ request.url.netloc }}/api/highlights \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -F "text=Your highlight text" \
  -F "source_title=Book Title" \
  -F "source_author=Author Name"</pre>
    </div>
</div>
{% endblock %}
